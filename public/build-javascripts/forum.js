!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.pica=e()}}(function(){return function e(t,i,r){function n(o,s){if(!i[o]){if(!t[o]){var u="function"==typeof require&&require;if(!s&&u)return u(o,!0);if(a)return a(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var d=i[o]={exports:{}};t[o][0].call(d.exports,function(e){var i=t[o][1][e];return n(i?i:e)},d,d.exports,e,t,i,r)}return i[o].exports}for(var a="function"==typeof require&&require,o=0;o<r.length;o++)n(r[o]);return n}({1:[function(e,t){"use strict";t.exports=function(){return document.createElement("canvas")}},{}],2:[function(e,t){"use strict";var i=1;t.exports=function(){return i++}},{}],3:[function(e,t){"use strict";function i(e){this.create=e,this.available=[],this.acquired={},this.lastId=1,this.timeoutId=0}var r=2e3,n=500;i.prototype.acquire=function(){var e,t=this;return 0!==this.available.length?e=this.available.pop():(e=this.create(),e.id=this.lastId++,e.release=function(){t.release(e)}),this.acquired[e.id]=e,e},i.prototype.release=function(e){delete this.acquired[e.id],e.lastUsed=Date.now(),this.available.push(e),0===this.timeoutId&&(this.timeoutId=setTimeout(this.gc.bind(this),n))},i.prototype.gc=function(){var e=Date.now();this.available=this.available.filter(function(t){return e-t.lastUsed>r?(t.destroy(),!1):!0}),this.timeoutId=0!==this.available.length?setTimeout(this.gc.bind(this),n):0},t.exports=i},{}],4:[function(e,t){"use strict";function i(e){return 0>e?0:e>255?255:e}function r(e){return Math.round(e*((1<<l)-1))}function n(e,t,i,n,a){var o,s,u,l,c,h,f,g,p,m,v,b,x,w,y,S,E,T=d[e].filter,R=1/n,I=Math.min(1,n),_=d[e].win/I,P=Math.floor(2*(_+1)),M=new Int16Array((P+2)*i),C=0;for(o=0;i>o;o++){for(s=(o+.5)*R+a,u=Math.max(0,Math.floor(s-_)),l=Math.min(t-1,Math.ceil(s+_)),c=l-u+1,h=new Float32Array(c),f=new Int16Array(c),g=0,p=u,m=0;l>=p;p++,m++)v=T((p+.5-s)*I),g+=v,h[m]=v;for(b=0,m=0;m<h.length;m++)x=h[m]/g,b+=x,f[m]=r(x);for(f[i>>1]+=r(1-b),w=0;w<f.length&&0===f[w];)w++;if(w<f.length){for(y=f.length-1;y>0&&0===f[y];)y--;S=u+w,E=y-w+1,M[C++]=S,M[C++]=E,M.set(f.subarray(w,y+1),C),C+=E}else M[C++]=0,M[C++]=0}return M}function a(e,t,r,n,a,o){var s,u,l,d,c,h,f,g,p,m,v,b=0,x=0;for(p=0;n>p;p++){for(c=0,m=0;a>m;m++){for(h=o[c++],f=o[c++],g=b+4*h|0,s=u=l=d=0;f>0;f--)v=o[c++],d=d+v*e[g+3]|0,l=l+v*e[g+2]|0,u=u+v*e[g+1]|0,s=s+v*e[g]|0,g=g+4|0;t[x+3]=i(d+8192>>14),t[x+2]=i(l+8192>>14),t[x+1]=i(u+8192>>14),t[x]=i(s+8192>>14),x=x+4*n|0}x=4*(p+1)|0,b=(p+1)*r*4|0}}function o(e,t,r,n,a,o){var s,u,l,d,c,h,f,g,p,m,v,b=0,x=0;for(p=0;n>p;p++){for(c=0,m=0;a>m;m++){for(h=o[c++],f=o[c++],g=b+4*h|0,s=u=l=d=0;f>0;f--)v=o[c++],d=d+v*e[g+3]|0,l=l+v*e[g+2]|0,u=u+v*e[g+1]|0,s=s+v*e[g]|0,g=g+4|0;t[x+3]=i(d+8192>>14),t[x+2]=i(l+8192>>14),t[x+1]=i(u+8192>>14),t[x]=i(s+8192>>14),x=x+4*n|0}x=4*(p+1)|0,b=(p+1)*r*4|0}}function s(e,t,i){for(var r=3,n=t*i*4|0;n>r;)e[r]=255,r=r+4|0}function u(e){var t=e.src,i=e.width,r=e.height,u=e.toWidth,l=e.toHeight,d=e.scaleX||e.toWidth/e.width,c=e.scaleY||e.toHeight/e.height,h=e.offsetX||0,f=e.offsetY||0,g=e.dest||new Uint8Array(u*l*4),p="undefined"==typeof e.quality?3:e.quality,m=e.alpha||!1;if(1>i||1>r||1>u||1>l)return[];var v=n(p,i,u,d,h),b=n(p,r,l,c,f),x=new Uint8Array(u*r*4);return a(t,x,i,r,u,v),o(x,g,r,u,l,b),m||s(g,u,l),g}var l=14,d=[{win:.5,filter:function(e){return e>=-.5&&.5>e?1:0}},{win:1,filter:function(e){if(-1>=e||e>=1)return 0;if(e>-1.1920929e-7&&1.1920929e-7>e)return 1;var t=e*Math.PI;return Math.sin(t)/t*(.54+.46*Math.cos(t/1))}},{win:2,filter:function(e){if(-2>=e||e>=2)return 0;if(e>-1.1920929e-7&&1.1920929e-7>e)return 1;var t=e*Math.PI;return Math.sin(t)/t*Math.sin(t/2)/(t/2)}},{win:3,filter:function(e){if(-3>=e||e>=3)return 0;if(e>-1.1920929e-7&&1.1920929e-7>e)return 1;var t=e*Math.PI;return Math.sin(t)/t*Math.sin(t/3)/(t/3)}}];t.exports=u},{}],5:[function(e,t){"use strict";function i(e,t,i){for(var r,n,a,o,s,u=t*i,l=new Uint16Array(u),d=0;u>d;d++)r=e[4*d],n=e[4*d+1],a=e[4*d+2],s=r>=n&&r>=a?r:n>=a&&n>=r?n:a,o=n>=r&&a>=r?r:a>=n&&r>=n?n:a,l[d]=257*(s+o)>>1;return l}function r(e,t,r,a,o,s){var u,l,d,c,h,f,g,p,m,v,b,x,w;if(!(0===a||.5>o)){o>2&&(o=2);var y=i(e,t,r),S=new Uint16Array(y);n(S,t,r,o);for(var E=a/100*4096+.5|0,T=257*s|0,R=t*r,I=0;R>I;I++)x=2*(y[I]-S[I]),Math.abs(x)>=T&&(w=4*I,u=e[w],l=e[w+1],d=e[w+2],p=u>=l&&u>=d?u:l>=u&&l>=d?l:d,g=l>=u&&d>=u?u:u>=l&&d>=l?l:d,f=257*(p+g)>>1,g===p?c=h=0:(h=32767>=f?4095*(p-g)/(p+g)|0:4095*(p-g)/(510-p-g)|0,c=u===p?65535*(l-d)/(6*(p-g))|0:l===p?21845+(65535*(d-u)/(6*(p-g))|0):43690+(65535*(u-l)/(6*(p-g))|0)),f+=E*x+2048>>12,f>65535?f=65535:0>f&&(f=0),0===h?u=l=d=f>>8:(v=32767>=f?f*(4096+h)+2048>>12:f+((65535-f)*h+2048>>12),m=2*f-v>>8,v>>=8,b=c+21845&65535,u=b>=43690?m:b>=32767?m+(6*(v-m)*(43690-b)+32768>>16):b>=10922?v:m+(6*(v-m)*b+32768>>16),b=65535&c,l=b>=43690?m:b>=32767?m+(6*(v-m)*(43690-b)+32768>>16):b>=10922?v:m+(6*(v-m)*b+32768>>16),b=c-21845&65535,d=b>=43690?m:b>=32767?m+(6*(v-m)*(43690-b)+32768>>16):b>=10922?v:m+(6*(v-m)*b+32768>>16)),e[w]=u,e[w+1]=l,e[w+2]=d)}}var n=e("glur/mono16");t.exports=r,t.exports.lightness=i},{"glur/mono16":11}],6:[function(e,t){"use strict";t.exports.createRegions=function(e){var t,i,r,n,a,o,s,u=e.toWidth/e.width,l=e.toHeight/e.height,d=Math.floor(e.srcTileSize*u)-2*e.destTileBorder,c=Math.floor(e.srcTileSize*l)-2*e.destTileBorder,h=[];for(n=0;n<e.toHeight;n+=c)for(r=0;r<e.toWidth;r+=d)t=r-e.destTileBorder,0>t&&(t=0),a=r+d+e.destTileBorder-t,t+a>=e.toWidth&&(a=e.toWidth-t),i=n-e.destTileBorder,0>i&&(i=0),o=n+c+e.destTileBorder-i,i+o>=e.toHeight&&(o=e.toHeight-i),s={toX:t,toY:i,toWidth:a,toHeight:o,toInnerX:r,toInnerY:n,toInnerWidth:d,toInnerHeight:c,offsetX:t/u-Math.floor(t/u),offsetY:i/l-Math.floor(i/l),scaleX:u,scaleY:l,x:Math.floor(t/u),y:Math.floor(i/l),width:Math.ceil(a/u),height:Math.ceil(o/l)},h.push(s);return h},t.exports.eachLimit=function(e,t,i,r){0===e.length&&r();for(var n=0,a=0,o=!1,s=function(t){if(!o){if(t)return o=!0,void r(t);a++,a===e.length?r():n<e.length&&i(e[n++],s)}};t>n&&n<e.length;)i(e[n++],s)}},{}],7:[function(e,t){"use strict";t.exports=function(t){var i=e("./resize_array"),r=e("./unsharp");t.onmessage=function(e){var n=e.data;n.dest=new Uint8Array(n.toWidth*n.toHeight*4),i(n),n.unsharpAmount&&r(n.dest,n.toWidth,n.toHeight,n.unsharpAmount,n.unsharpRadius,n.unsharpThreshold),t.postMessage({output:n.dest},[n.dest.buffer])}}},{"./resize_array":4,"./unsharp":5}],8:[function(e,t){"use strict";function i(e,t,i,c){var h=t.getContext("2d",{alpha:Boolean(i.alpha)}),f=u();f.width=Math.min(l,e.width),f.height=Math.min(l,e.height);var g=f.getContext("2d",{alpha:Boolean(i.alpha)});g.globalCompositeOperation="copy";var p=a({width:e.naturalWidth||e.width,height:e.naturalHeight||e.height,srcTileSize:l,toWidth:t.width,toHeight:t.height,destTileBorder:Math.ceil(Math.max(d,2.5*i.unsharpRadius|0))});return o(p,1,function(t,a){g.drawImage(e,t.x,t.y,t.width,t.height,0,0,t.width,t.height);var o=g.getImageData(0,0,t.width,t.height),s=h.createImageData(t.toWidth,t.toHeight),u={src:o.data,dest:s.data,width:t.width,height:t.height,toWidth:t.toWidth,toHeight:t.toHeight,scaleX:t.scaleX,scaleY:t.scaleY,offsetX:t.offsetX,offsetY:t.offsetY,quality:i.quality,alpha:i.alpha,unsharpAmount:i.unsharpAmount,unsharpRadius:i.unsharpRadius,unsharpThreshold:i.unsharpThreshold};r(u),i.unsharpAmount&&n(u.dest,u.toWidth,u.toHeight,u.unsharpAmount,u.unsharpRadius,u.unsharpThreshold),h.putImageData(s,t.toX,t.toY,t.toInnerX-t.toX,t.toInnerY-t.toY,t.toInnerWidth,t.toInnerHeight),a()},c),s()}var r=e("./js/resize_array"),n=e("./js/unsharp"),a=e("./js/utils").createRegions,o=e("./js/utils").eachLimit,s=e("./js/generate_id"),u=e("./js/create_canvas"),l=1024,d=3;t.exports=i,t.exports.terminate=function(){}},{"./js/create_canvas":1,"./js/generate_id":2,"./js/resize_array":4,"./js/unsharp":5,"./js/utils":6}],9:[function(e,t){"use strict";function i(e,t,i,r){var n=t.getContext("2d",{alpha:Boolean(i.alpha)}),a=l();a.width=Math.min(c,e.naturalWidth||e.width),a.height=Math.min(c,e.naturalHeight||e.height);var d=a.getContext("2d",{alpha:Boolean(i.alpha)});d.globalCompositeOperation="copy";var p=o({width:e.naturalWidth||e.width,height:e.naturalHeight||e.height,srcTileSize:c,toWidth:t.width,toHeight:t.height,destTileBorder:Math.ceil(Math.max(h,2.5*i.unsharpRadius|0))}),m=navigator&&navigator.hardwareConcurrency||4,v=i._id||u();return g[v]=!0,s(p,m,function(t,r){d.drawImage(e,t.x,t.y,t.width,t.height,0,0,t.width,t.height);var a=d.getImageData(0,0,t.width,t.height),o={src:a.data,width:t.width,height:t.height,toWidth:t.toWidth,toHeight:t.toHeight,scaleX:t.scaleX,scaleY:t.scaleY,offsetX:t.offsetX,offsetY:t.offsetY,quality:i.quality,alpha:i.alpha,unsharpAmount:i.unsharpAmount,unsharpRadius:i.unsharpRadius,unsharpThreshold:i.unsharpThreshold},s=f.acquire();s.value.onmessage=function(e){var i,a,o,u,l;if(s.release(),!g[v])return void r(!0);if(e.data.err)return void r(e.data.err);if(o=n.createImageData(t.toWidth,t.toHeight),u=e.data.output,l=o.data,l.set)l.set(u);else for(i=0,a=u.length;a>i;i++)l[i]=u[i];n.putImageData(o,t.toX,t.toY,t.toInnerX-t.toX,t.toInnerY-t.toY,t.toInnerWidth,t.toInnerHeight),r()},s.value.postMessage(o,[o.src.buffer])},function(e){g[v]&&(delete g[v],r(e))}),v}function r(e){g[e]&&delete g[e]}var n=e("webworkify"),a=e("./js/worker.js"),o=e("./js/utils").createRegions,s=e("./js/utils").eachLimit,u=e("./js/generate_id"),l=e("./js/create_canvas"),d=e("./js/pool"),c=1024,h=3,f=new d(function(){return{value:n(a),destroy:function(){this.value.terminate()}}}),g={};t.exports=i,t.exports.terminate=r},{"./js/create_canvas":1,"./js/generate_id":2,"./js/pool":3,"./js/utils":6,"./js/worker.js":7,webworkify:13}],10:[function(e,t){"use strict";function i(e){try{(window.console.error||window.console.log).call(window.console,e)}catch(t){}}function r(e){var t=e.getError();if(t!==e.NO_ERROR)throw new Error("gl error "+t)}function n(e){return e.getContext("webgl")||e.getContext("experimental-webgl")}function a(e,t,r){var n=e.createShader(t);return e.shaderSource(n,r),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS)?n:(i("Shader compile error: "+e.getShaderInfoLog(n)+". Source: `"+r+"`"),e.deleteShader(n),null)}function o(e,t,n){var o=a(e,e.VERTEX_SHADER,b[t]),s=a(e,e.FRAGMENT_SHADER,b[n]),u=e.createProgram();return e.attachShader(u,o),e.attachShader(u,s),e.linkProgram(u),e.getProgramParameter(u,e.LINK_STATUS)||(i("Program linking error: "+e.getProgramInfoLog(u)),e.deleteProgram(u)),r(e),u}function s(e,t,i,n,a){var o=e.getAttribLocation(t,i);e.bindBuffer(e.ARRAY_BUFFER,e.createBuffer()),e.bufferData(e.ARRAY_BUFFER,new Float32Array(n),e.STATIC_DRAW),e.enableVertexAttribArray(o),e.vertexAttribPointer(o,a.elementSize,e.FLOAT,!1,0,0),r(e)}function u(e,t,i){var n=e.createTexture();return e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,i),r(e),n}function l(e,t,i,r){var n=e.getUniformLocation(t,i);e.uniform1i(n,r)}function d(e,t,i,r,n){var a=e.getUniformLocation(t,i);e.uniform2f(a,r,n)}function c(e,t,i,r){var n=e,a=e+i,o=t,s=t+r;return[n,o,a,o,n,s,n,s,a,o,a,s]}function h(e,t,i,n){var a=e.createTexture();return e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,a),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,i,n,0,e.RGBA,e.UNSIGNED_BYTE,null),r(e),a}function f(e,t,i,n){var a=h(e,t,i,n),o=e.getParameter(e.FRAMEBUFFER_BINDING),s=e.createFramebuffer();return e.bindFramebuffer(e.FRAMEBUFFER,s),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,a,0),r(e),{fbo:s,texture:a,oldFbo:o}}function g(e,t,i,n,a,u,h,g,p){var m=o(e,"#vsh-basic",u);e.useProgram(m),l(e,m,"u_image",t),d(e,m,"u_imageSize",i,n),d(e,m,"u_resolution",h,g),s(e,m,"a_texCoord",[0,0,1,0,0,1,0,1,1,0,1,1],{elementSize:2}),s(e,m,"a_position",p?c(0,g,h,-g):c(0,0,h,g),{elementSize:2}),e.viewport(0,0,h,g);var v=f(e,a,h,g);return e.viewport(0,0,h,g),e.drawArrays(e.TRIANGLES,0,6),e.bindFramebuffer(e.FRAMEBUFFER,v.oldFbo),r(e),v}function p(e,t,i){var r=e.naturalWidth||e.width,n=e.naturalHeight||e.height,a=t.canvas.width,o=t.canvas.height;t.viewport(0,0,a,o);var s=0;u(t,s,e);var l=2,d=3;g(t,s,r,n,l,"#fsh-lanczos-1d-covolve-horizontal",a,n,!1);var c=g(t,l,a,n,d,"#fsh-lanczos-1d-covolve-vertical",a,o,!0);t.flush();var h=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,h),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,c.texture,0);var f=t.checkFramebufferStatus(t.FRAMEBUFFER);if(f!==t.FRAMEBUFFER_COMPLETE)throw new Error("Bad framebuffer status: "+f);i.alpha||(t.clearColor(1,1,1,1),t.colorMask(!1,!1,!1,!0),t.clear(t.COLOR_BUFFER_BIT));var p=new Uint8Array(a*o*4);t.readPixels(0,0,a,o,t.RGBA,t.UNSIGNED_BYTE,p);var v="undefined"==typeof i.unsharpAmount?0:0|i.unsharpAmount,b="undefined"==typeof i.unsharpRadius?0:i.unsharpRadius,x="undefined"==typeof i.unsharpThreshold?0:0|i.unsharpThreshold;return v&&m(p,a,o,v,b,x),p}var m=e("./js/unsharp"),v=e("./js/generate_id"),b={};b["#vsh-basic"]="precision highp float;\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\n\nuniform vec2 u_resolution;\n\nvarying vec2 v_texCoord;\n\nvoid main() {\n   vec2 clipSpace = a_position / u_resolution * 2.0 - 1.0;\n\n   gl_Position = vec4(clipSpace, 0, 1);\n   v_texCoord = a_texCoord;\n}\n",b["#fsh-lanczos-1d-covolve-horizontal"]="precision highp float;\nuniform vec2 u_resolution;\nuniform sampler2D u_image;\nuniform vec2 u_imageSize;\n\n#define winSize 3.0\n\nvarying vec2 v_texCoord;\n\n#define sinc(a) (sin(a)/a)\n#define M_PI 3.1415926535897932384626433832795\n\nvoid main() {\n  vec2 pixel = vec2(1.) / u_imageSize;\n  gl_FragColor = vec4(0.);\n\n  float total = 0.;\n  float scale = u_imageSize.x / u_resolution.x;\n  float count = winSize * scale * 2.;\n  for (int i = 0; i < 1024*8; i++) {\n    if (float(i) >= count) {\n      break;\n    }\n    float k = float(i) - (count / 2.);\n    vec2 offset = vec2(pixel.x * k, 0.);\n    vec4 c = texture2D(u_image, v_texCoord+offset);\n    float x = k / scale; // max [-3, 3]\n    float xpi = x * M_PI;\n    float b = sinc(xpi) * sinc(xpi / winSize);\n    if (x > -1.19209290E-07 && x < 1.19209290E-07) { \n      b = 1.;\n    }\n    total += b;\n    c *= vec4(b);\n    gl_FragColor += c;\n  }\n  gl_FragColor /= vec4(total);\n}\n",b["#fsh-lanczos-1d-covolve-vertical"]="precision highp float;\nuniform vec2 u_resolution;\nuniform sampler2D u_image;\nuniform vec2 u_imageSize;\n\n#define winSize 3.0\n\nvarying vec2 v_texCoord;\n\n#define sinc(a) (sin(a)/a)\n#define M_PI 3.1415926535897932384626433832795\n\nvoid main() {\n  vec2 pixel = vec2(1.) / u_imageSize;\n  gl_FragColor = vec4(0.);\n\n  float total = 0.;\n  float scale = u_imageSize.y / u_resolution.y;\n  float count = winSize * scale * 2.;\n  for (int i = 0; i < 1024*8; i++) {\n    if (float(i) >= count) {\n      break;\n    }\n    float k = float(i) - (count / 2.);\n    vec2 offset = vec2(0., pixel.y * k);\n    vec4 c = texture2D(u_image, v_texCoord+offset);\n    float x = k / scale; // max [-3, 3]\n    float xpi = x * M_PI;\n    float b = sinc(xpi) * sinc(xpi / winSize);\n    if (x > -1.19209290E-07 && x < 1.19209290E-07) { \n      b = 1.;\n    }\n    total += b;\n    c *= vec4(b);\n    gl_FragColor += c;\n  }\n  gl_FragColor /= vec4(total);\n}\n",t.exports=function(e,t,r,a){var o,s;try{s=document.createElement("canvas"),s.id="pica-webgl-temporarry-canvas",s.height=t.height,s.width=t.width,document.body.appendChild(s),o=n(s);var u=p(e,o,r);o.finish(),document.body.removeChild(s);var l=t.getContext("2d"),d=l.createImageData(t.width,t.height);d.data.set(u),l.putImageData(d,0,0),a(null,u)}catch(c){i(c),o.finish(),document.body.removeChild(s),a(c)}return v()},t.exports.terminate=function(){}},{"./js/generate_id":2,"./js/unsharp":5}],11:[function(e,t){function i(e){.5>e&&(e=.5);var t=Math.exp(.527076)/e,i=Math.exp(-t),r=Math.exp(-2*t),n=(1-i)*(1-i)/(1+2*t*i-r);return a=n,o=n*(t-1)*i,s=n*(t+1)*i,u=-n*r,l=2*i,d=-r,c=(a+o)/(1-l-d),h=(s+u)/(1-l-d),new Float32Array([a,o,s,u,l,d,c,h])}function r(e,t,i,r,n,a){var o,s,u,l,d,c,h,f,g,p,m,v,b,x;for(g=0;a>g;g++){for(c=g*n,h=g,f=0,o=e[c],d=o*r[6],l=d,m=r[0],v=r[1],b=r[4],x=r[5],p=0;n>p;p++)s=e[c],u=s*m+o*v+l*b+d*x,d=l,l=u,o=s,i[f]=l,f++,c++;for(c--,f--,h+=a*(n-1),o=e[c],d=o*r[7],l=d,s=o,m=r[2],v=r[3],p=n-1;p>=0;p--)u=s*m+o*v+l*b+d*x,d=l,l=u,o=s,s=e[c],t[h]=i[f]+l,c--,f--,h-=a}}function n(e,t,n,a){if(a){var o=new Uint16Array(e.length),s=new Float32Array(Math.max(t,n)),u=i(a);r(e,o,s,u,t,n,a),r(o,e,s,u,n,t,a)}}var a,o,s,u,l,d,c,h;t.exports=n},{}],12:[function(e,t){"use strict";function i(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}var r=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable;t.exports=Object.assign||function(e){for(var t,a,o=i(e),s=1;s<arguments.length;s++){t=Object(arguments[s]);for(var u in t)r.call(t,u)&&(o[u]=t[u]);if(Object.getOwnPropertySymbols){a=Object.getOwnPropertySymbols(t);for(var l=0;l<a.length;l++)n.call(t,a[l])&&(o[a[l]]=t[a[l]])}}return o}},{}],13:[function(e,t){var i=arguments[3],r=arguments[4],n=arguments[5],a=JSON.stringify;t.exports=function(e){for(var t,o=Object.keys(n),s=0,u=o.length;u>s;s++){var l=o[s];if(n[l].exports===e){t=l;break}}if(!t){t=Math.floor(Math.pow(16,8)*Math.random()).toString(16);for(var d={},s=0,u=o.length;u>s;s++){var l=o[s];d[l]=l}r[t]=[Function(["require","module","exports"],"("+e+")(self)"),d]}var c=Math.floor(Math.pow(16,8)*Math.random()).toString(16),h={};h[t]=t,r[c]=[Function(["require"],"require("+a(t)+")(self)"),h];var f="("+i+")({"+Object.keys(r).map(function(e){return a(e)+":["+r[e][0]+","+a(r[e][1])+"]"}).join(",")+"},{},["+a(c)+"])",g=window.URL||window.webkitURL||window.mozURL||window.msURL;return new Worker(g.createObjectURL(new Blob([f],{type:"text/javascript"})))}},{}],"/":[function(e,t,i){"use strict";function r(e){return Object.prototype.toString.call(e)}function n(e){return"[object Function]"===r(e)}function a(e,t,r,o){if(n(r)&&(o=r,r={}),isNaN(r)||(r={quality:r,alpha:!1}),h||(i.WEBGL=!1),h&&i.WEBGL){i.debug("Resize canvas with WebGL");var s=p(e,t,r,function(n){n?(i.debug("WebGL resize failed, do fallback and cancel next attempts"),i.debug(n),h=!1,a(e,t,b({},r,{_id:s}),o)):o()});return s}return u||(i.WW=!1),u&&i.WW?(i.debug("Resize buffer in WebWorker"),g(e,t,r,o)):(i.debug("Resize buffer sync (freeze event loop)"),f(e,t,r,o))}function o(e,t){var i={src:e.src,dest:e.dest,width:0|e.width,height:0|e.height,toWidth:0|e.toWidth,toHeight:0|e.toHeight,quality:e.quality,alpha:e.alpha,unsharpAmount:e.unsharpAmount,unsharpRadius:e.unsharpRadius,unsharpThreshold:e.unsharpThreshold};i.dest=m(i),i.unsharpAmount&&v(i.dest,i.toWidth,i.toHeight,i.unsharpAmount,i.unsharpRadius,i.unsharpThreshold),t(null,i.dest)}function s(e){f.terminate(e),g.terminate(e),p.terminate(e)}var u="undefined"!=typeof window&&"Worker"in window;if(u)try{var l=e("webworkify")(function(){});l.terminate()}catch(d){u=!1}var c,h=!1;try{"undefined"!=typeof document&&"undefined"!=typeof window&&window.WebGLRenderingContext&&(c=document.createElement("canvas"),(c.getContext("webgl")||c.getContext("experimental-webgl"))&&(h=!0))}catch(d){}finally{c=null}var f=e("./lib/resize_js"),g=e("./lib/resize_js_ww"),p=e("./lib/resize_webgl"),m=e("./lib/js/resize_array"),v=e("./lib/js/unsharp"),b=e("object-assign");i.resizeCanvas=a,i.resizeBuffer=o,i.terminate=s,i.WW=u,i.WEBGL=!1,i.debug=function(){}},{"./lib/js/resize_array":4,"./lib/js/unsharp":5,"./lib/resize_js":8,"./lib/resize_js_ww":9,"./lib/resize_webgl":10,"object-assign":12,webworkify:13}]},{},[])("/")}),!function(e){"use strict";var t=function(e,i,r){var n,a,o=document.createElement("img");if(o.onerror=i,o.onload=function(){!a||r&&r.noRevoke||t.revokeObjectURL(a),i&&i(t.scale(o,r))},t.isInstanceOf("Blob",e)||t.isInstanceOf("File",e))n=a=t.createObjectURL(e),o._type=e.type;else{if("string"!=typeof e)return!1;n=e,r&&r.crossOrigin&&(o.crossOrigin=r.crossOrigin)}return n?(o.src=n,o):t.readFile(e,function(e){var t=e.target;t&&t.result?o.src=t.result:i&&i(e)})},i=window.createObjectURL&&window||window.URL&&URL.revokeObjectURL&&URL||window.webkitURL&&webkitURL;t.isInstanceOf=function(e,t){return Object.prototype.toString.call(t)==="[object "+e+"]"},t.transformCoordinates=function(){},t.getTransformedOptions=function(e,t){var i,r,n,a,o=t.aspectRatio;if(!o)return t;i={};for(r in t)t.hasOwnProperty(r)&&(i[r]=t[r]);return i.crop=!0,n=e.naturalWidth||e.width,a=e.naturalHeight||e.height,n/a>o?(i.maxWidth=a*o,i.maxHeight=a):(i.maxWidth=n,i.maxHeight=n/o),i},t.renderImageToCanvas=function(e,t,i,r,n,a,o,s,u,l){return e.getContext("2d").drawImage(t,i,r,n,a,o,s,u,l),e},t.hasCanvasOption=function(e){return e.canvas||e.crop||!!e.aspectRatio},t.scale=function(e,i){function r(){var e=Math.max((s||w)/w,(u||y)/y);e>1&&(w*=e,y*=e)}function n(){var e=Math.min((a||w)/w,(o||y)/y);1>e&&(w*=e,y*=e)}i=i||{};var a,o,s,u,l,d,c,h,f,g,p,m=document.createElement("canvas"),v=e.getContext||t.hasCanvasOption(i)&&m.getContext,b=e.naturalWidth||e.width,x=e.naturalHeight||e.height,w=b,y=x;if(v&&(i=t.getTransformedOptions(e,i),c=i.left||0,h=i.top||0,i.sourceWidth?(l=i.sourceWidth,void 0!==i.right&&void 0===i.left&&(c=b-l-i.right)):l=b-c-(i.right||0),i.sourceHeight?(d=i.sourceHeight,void 0!==i.bottom&&void 0===i.top&&(h=x-d-i.bottom)):d=x-h-(i.bottom||0),w=l,y=d),a=i.maxWidth,o=i.maxHeight,s=i.minWidth,u=i.minHeight,v&&a&&o&&i.crop?(w=a,y=o,p=l/d-a/o,0>p?(d=o*l/a,void 0===i.top&&void 0===i.bottom&&(h=(x-d)/2)):p>0&&(l=a*d/o,void 0===i.left&&void 0===i.right&&(c=(b-l)/2))):((i.contain||i.cover)&&(s=a=a||s,u=o=o||u),i.cover?(n(),r()):(r(),n())),v){if(f=i.pixelRatio,f>1&&(m.style.width=w+"px",m.style.height=y+"px",w*=f,y*=f,m.getContext("2d").scale(f,f)),g=i.downsamplingRatio,g>0&&1>g&&l>w&&d>y)for(;l*g>w;)m.width=l*g,m.height=d*g,t.renderImageToCanvas(m,e,c,h,l,d,0,0,m.width,m.height),l=m.width,d=m.height,e=document.createElement("canvas"),e.width=l,e.height=d,t.renderImageToCanvas(e,m,0,0,l,d,0,0,l,d);return m.width=w,m.height=y,t.transformCoordinates(m,i),t.renderImageToCanvas(m,e,c,h,l,d,0,0,w,y)}return e.width=w,e.height=y,e},t.createObjectURL=function(e){return i?i.createObjectURL(e):!1},t.revokeObjectURL=function(e){return i?i.revokeObjectURL(e):!1},t.readFile=function(e,t,i){if(window.FileReader){var r=new FileReader;if(r.onload=r.onerror=t,i=i||"readAsDataURL",r[i])return r[i](e),r}return!1},"function"==typeof define&&define.amd?define(function(){return t}):"object"==typeof module&&module.exports?module.exports=t:e.loadImage=t}(window),function(e){"use strict";"function"==typeof define&&define.amd?define(["./load-image"],e):e("object"==typeof module&&module.exports?require("./load-image"):window.loadImage)}(function(e){"use strict";var t=e.hasCanvasOption,i=e.transformCoordinates,r=e.getTransformedOptions;e.hasCanvasOption=function(i){return!!i.orientation||t.call(e,i)},e.transformCoordinates=function(t,r){i.call(e,t,r);var n=t.getContext("2d"),a=t.width,o=t.height,s=t.style.width,u=t.style.height,l=r.orientation;if(l&&!(l>8))switch(l>4&&(t.width=o,t.height=a,t.style.width=u,t.style.height=s),l){case 2:n.translate(a,0),n.scale(-1,1);break;case 3:n.translate(a,o),n.rotate(Math.PI);break;case 4:n.translate(0,o),n.scale(1,-1);break;case 5:n.rotate(.5*Math.PI),n.scale(1,-1);break;case 6:n.rotate(.5*Math.PI),n.translate(0,-o);break;case 7:n.rotate(.5*Math.PI),n.translate(a,-o),n.scale(-1,1);break;case 8:n.rotate(-.5*Math.PI),n.translate(-a,0)}},e.getTransformedOptions=function(t,i){var n,a,o=r.call(e,t,i),s=o.orientation;if(!s||s>8||1===s)return o;n={};for(a in o)o.hasOwnProperty(a)&&(n[a]=o[a]);switch(o.orientation){case 2:n.left=o.right,n.right=o.left;break;case 3:n.left=o.right,n.top=o.bottom,n.right=o.left,n.bottom=o.top;break;case 4:n.top=o.bottom,n.bottom=o.top;break;case 5:n.left=o.top,n.top=o.left,n.right=o.bottom,n.bottom=o.right;break;case 6:n.left=o.top,n.top=o.right,n.right=o.bottom,n.bottom=o.left;break;case 7:n.left=o.bottom,n.top=o.right,n.right=o.top,n.bottom=o.left;break;case 8:n.left=o.bottom,n.top=o.left,n.right=o.top,n.bottom=o.right}return o.orientation>4&&(n.maxWidth=o.maxHeight,n.maxHeight=o.maxWidth,n.minWidth=o.minHeight,n.minHeight=o.minWidth,n.sourceWidth=o.sourceHeight,n.sourceHeight=o.sourceWidth),n}}),function(e){"use strict";"function"==typeof define&&define.amd?define(["./load-image"],e):e("object"==typeof module&&module.exports?require("./load-image"):window.loadImage)}(function(e){"use strict";var t=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);e.blobSlice=t&&function(){var e=this.slice||this.webkitSlice||this.mozSlice;return e.apply(this,arguments)},e.metaDataParsers={jpeg:{65505:[]}},e.parseMetaData=function(t,i,r){r=r||{};var n=this,a=r.maxMetaDataSize||262144,o={},s=!(window.DataView&&t&&t.size>=12&&"image/jpeg"===t.type&&e.blobSlice);(s||!e.readFile(e.blobSlice.call(t,0,a),function(t){if(t.target.error)return console.log(t.target.error),void i(o);var a,s,u,l,d=t.target.result,c=new DataView(d),h=2,f=c.byteLength-4,g=h;if(65496===c.getUint16(0)){for(;f>h&&(a=c.getUint16(h),a>=65504&&65519>=a||65534===a);){if(s=c.getUint16(h+2)+2,h+s>c.byteLength){console.log("Invalid meta data: Invalid segment size.");break}if(u=e.metaDataParsers.jpeg[a])for(l=0;l<u.length;l+=1)u[l].call(n,c,h,s,o,r);h+=s,g=h}!r.disableImageHead&&g>6&&(o.imageHead=d.slice?d.slice(0,g):new Uint8Array(d).subarray(0,g))}else console.log("Invalid JPEG file: Missing JPEG marker.");i(o)},"readAsArrayBuffer"))&&i(o)}}),function(e){"use strict";"function"==typeof define&&define.amd?define(["./load-image","./load-image-meta"],e):"object"==typeof module&&module.exports?e(require("./load-image"),require("./load-image-meta")):e(window.loadImage)}(function(e){"use strict";e.ExifMap=function(){return this},e.ExifMap.prototype.map={Orientation:274},e.ExifMap.prototype.get=function(e){return this[e]||this[this.map[e]]},e.getExifThumbnail=function(e,t,i){var r,n,a;if(!i||t+i>e.byteLength)return void console.log("Invalid Exif data: Invalid thumbnail data.");for(r=[],n=0;i>n;n+=1)a=e.getUint8(t+n),r.push((16>a?"0":"")+a.toString(16));return"data:image/jpeg,%"+r.join("%")},e.exifTagTypes={1:{getValue:function(e,t){return e.getUint8(t)},size:1},2:{getValue:function(e,t){return String.fromCharCode(e.getUint8(t))},size:1,ascii:!0},3:{getValue:function(e,t,i){return e.getUint16(t,i)},size:2},4:{getValue:function(e,t,i){return e.getUint32(t,i)},size:4},5:{getValue:function(e,t,i){return e.getUint32(t,i)/e.getUint32(t+4,i)},size:8},9:{getValue:function(e,t,i){return e.getInt32(t,i)},size:4},10:{getValue:function(e,t,i){return e.getInt32(t,i)/e.getInt32(t+4,i)},size:8}},e.exifTagTypes[7]=e.exifTagTypes[1],e.getExifValue=function(t,i,r,n,a,o){var s,u,l,d,c,h,f=e.exifTagTypes[n];if(!f)return void console.log("Invalid Exif data: Invalid tag type.");if(s=f.size*a,u=s>4?i+t.getUint32(r+8,o):r+8,u+s>t.byteLength)return void console.log("Invalid Exif data: Invalid data offset.");if(1===a)return f.getValue(t,u,o);for(l=[],d=0;a>d;d+=1)l[d]=f.getValue(t,u+d*f.size,o);if(f.ascii){for(c="",d=0;d<l.length&&(h=l[d],"\x00"!==h);d+=1)c+=h;return c}return l},e.parseExifTag=function(t,i,r,n,a){var o=t.getUint16(r,n);a.exif[o]=e.getExifValue(t,i,r,t.getUint16(r+2,n),t.getUint32(r+4,n),n)},e.parseExifTags=function(e,t,i,r,n){var a,o,s;if(i+6>e.byteLength)return void console.log("Invalid Exif data: Invalid directory offset.");if(a=e.getUint16(i,r),o=i+2+12*a,o+4>e.byteLength)return void console.log("Invalid Exif data: Invalid directory size.");for(s=0;a>s;s+=1)this.parseExifTag(e,t,i+2+12*s,r,n);return e.getUint32(o,r)},e.parseExifData=function(t,i,r,n,a){if(!a.disableExif){var o,s,u,l=i+10;if(1165519206===t.getUint32(i+4)){if(l+8>t.byteLength)return void console.log("Invalid Exif data: Invalid segment size.");if(0!==t.getUint16(i+8))return void console.log("Invalid Exif data: Missing byte alignment offset.");switch(t.getUint16(l)){case 18761:o=!0;break;case 19789:o=!1;break;default:return void console.log("Invalid Exif data: Invalid byte alignment marker.")}if(42!==t.getUint16(l+2,o))return void console.log("Invalid Exif data: Missing TIFF marker.");s=t.getUint32(l+4,o),n.exif=new e.ExifMap,s=e.parseExifTags(t,l,l+s,o,n),s&&!a.disableExifThumbnail&&(u={exif:{}},s=e.parseExifTags(t,l,l+s,o,u),u.exif[513]&&(n.exif.Thumbnail=e.getExifThumbnail(t,l+u.exif[513],u.exif[514]))),n.exif[34665]&&!a.disableExifSub&&e.parseExifTags(t,l,l+n.exif[34665],o,n),n.exif[34853]&&!a.disableExifGps&&e.parseExifTags(t,l,l+n.exif[34853],o,n)}}},e.metaDataParsers.jpeg[65505].push(e.parseExifData)}),function(e){"use strict";"function"==typeof define&&define.amd?define(["./load-image","./load-image-exif"],e):"object"==typeof module&&module.exports?e(require("./load-image"),require("./load-image-exif")):e(window.loadImage)}(function(e){"use strict";e.ExifMap.prototype.tags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright",36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",42240:"Gamma",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubSecTime",37521:"SubSecTimeOriginal",37522:"SubSecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"PhotographicSensitivity",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},e.ExifMap.prototype.stringValues={ExposureProgram:{0:"Undefined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Undefined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},ComponentsConfiguration:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"},Orientation:{1:"top-left",2:"top-right",3:"bottom-right",4:"bottom-left",5:"left-top",6:"right-top",7:"right-bottom",8:"left-bottom"}},e.ExifMap.prototype.getText=function(e){var t=this.get(e);
switch(e){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":case"Orientation":return this.stringValues[e][t];case"ExifVersion":case"FlashpixVersion":return String.fromCharCode(t[0],t[1],t[2],t[3]);case"ComponentsConfiguration":return this.stringValues[e][t[0]]+this.stringValues[e][t[1]]+this.stringValues[e][t[2]]+this.stringValues[e][t[3]];case"GPSVersionID":return t[0]+"."+t[1]+"."+t[2]+"."+t[3]}return String(t)},function(e){var t,i=e.tags,r=e.map;for(t in i)i.hasOwnProperty(t)&&(r[i[t]]=t)}(e.ExifMap.prototype),e.ExifMap.prototype.getAll=function(){var e,t,i={};for(e in this)this.hasOwnProperty(e)&&(t=this.tags[e],t&&(i[t]=this.getText(t)));return i}});var Upload=function(){function e(e){n.innerHTML="bezig...";var t=document.createElement("canvas");loadImage.parseMetaData(e,function(i){var o={canvas:!0};i.exif&&(o.orientation=i.exif.get("Orientation")),loadImage(e,function(i){console.log("hoi 1");var o=Math.min(i.width,a),s=i.height*o/i.width;t.width=o,t.height=s,pica.resizeCanvas(i,t,function(){console.log("hoi 2"),t.toBlob(function(e){console.log("hoi 3");var t=new XMLHttpRequest,i=new FormData;i.append("type","file"),i.append("image",e),t.open("POST","https://api.imgur.com/3/image",!0),t.setRequestHeader("Authorization","Client-ID c9fd3e097596f79"),t.setRequestHeader("Accept","application/json"),t.addEventListener("load",function(){console.log("hoi 4"),n.innerHTML="klik of sleep";var e=JSON.parse(this.responseText),t=e.data.link.replace(/^http:/,"");r.value+="\n![beschrijving]("+t+")"}),t.send(i)},e.type,.8)})},o)})}var t=document.getElementById("imgur-file-upload"),i=document.getElementById("reply-form"),r=document.getElementById("body"),n=document.getElementById("imgur-help-text"),a=631;i.addEventListener("dragover",function(e){e.preventDefault()},!0),i.addEventListener("drop",function(t){t.preventDefault(),e(t.dataTransfer.files[0])},!0),t.addEventListener("change",function(t){e(t.target.files[0])})}();