!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.pica=e()}}(function(){return function e(t,r,n){function i(o,s){if(!r[o]){if(!t[o]){var u="function"==typeof require&&require;if(!s&&u)return u(o,!0);if(a)return a(o,!0);var h=new Error("Cannot find module '"+o+"'");throw h.code="MODULE_NOT_FOUND",h}var l=r[o]={exports:{}};t[o][0].call(l.exports,function(e){var r=t[o][1][e];return i(r?r:e)},l,l.exports,e,t,r,n)}return r[o].exports}for(var a="function"==typeof require&&require,o=0;o<n.length;o++)i(n[o]);return i}({1:[function(e,t){"use strict";t.exports=function(){return document.createElement("canvas")}},{}],2:[function(e,t){"use strict";var r=1;t.exports=function(){return r++}},{}],3:[function(e,t){"use strict";function r(e){this.create=e,this.available=[],this.acquired={},this.lastId=1,this.timeoutId=0}var n=2e3,i=500;r.prototype.acquire=function(){var e,t=this;return 0!==this.available.length?e=this.available.pop():(e=this.create(),e.id=this.lastId++,e.release=function(){t.release(e)}),this.acquired[e.id]=e,e},r.prototype.release=function(e){delete this.acquired[e.id],e.lastUsed=Date.now(),this.available.push(e),0===this.timeoutId&&(this.timeoutId=setTimeout(this.gc.bind(this),i))},r.prototype.gc=function(){var e=Date.now();this.available=this.available.filter(function(t){return e-t.lastUsed>n?(t.destroy(),!1):!0}),this.timeoutId=0!==this.available.length?setTimeout(this.gc.bind(this),i):0},t.exports=r},{}],4:[function(e,t){"use strict";function r(e){return 0>e?0:e>255?255:e}function n(e){return Math.round(e*((1<<h)-1))}function i(e,t,r,i,a){var o,s,u,h,f,c,d,g,p,v,m,w,E,_,T,b,x,R=l[e].filter,y=1/i,A=Math.min(1,i),M=l[e].win/A,I=Math.floor(2*(M+1)),U=new Int16Array((I+2)*r),F=0;for(o=0;r>o;o++){for(s=(o+.5)*y+a,u=Math.max(0,Math.floor(s-M)),h=Math.min(t-1,Math.ceil(s+M)),f=h-u+1,c=new Float32Array(f),d=new Int16Array(f),g=0,p=u,v=0;h>=p;p++,v++)m=R((p+.5-s)*A),g+=m,c[v]=m;for(w=0,v=0;v<c.length;v++)E=c[v]/g,w+=E,d[v]=n(E);for(d[r>>1]+=n(1-w),_=0;_<d.length&&0===d[_];)_++;if(_<d.length){for(T=d.length-1;T>0&&0===d[T];)T--;b=u+_,x=T-_+1,U[F++]=b,U[F++]=x,U.set(d.subarray(_,T+1),F),F+=x}else U[F++]=0,U[F++]=0}return U}function a(e,t,n,i,a,o){var s,u,h,l,f,c,d,g,p,v,m,w=0,E=0;for(p=0;i>p;p++){for(f=0,v=0;a>v;v++){for(c=o[f++],d=o[f++],g=w+4*c|0,s=u=h=l=0;d>0;d--)m=o[f++],l=l+m*e[g+3]|0,h=h+m*e[g+2]|0,u=u+m*e[g+1]|0,s=s+m*e[g]|0,g=g+4|0;t[E+3]=r(l+8192>>14),t[E+2]=r(h+8192>>14),t[E+1]=r(u+8192>>14),t[E]=r(s+8192>>14),E=E+4*i|0}E=4*(p+1)|0,w=(p+1)*n*4|0}}function o(e,t,n,i,a,o){var s,u,h,l,f,c,d,g,p,v,m,w=0,E=0;for(p=0;i>p;p++){for(f=0,v=0;a>v;v++){for(c=o[f++],d=o[f++],g=w+4*c|0,s=u=h=l=0;d>0;d--)m=o[f++],l=l+m*e[g+3]|0,h=h+m*e[g+2]|0,u=u+m*e[g+1]|0,s=s+m*e[g]|0,g=g+4|0;t[E+3]=r(l+8192>>14),t[E+2]=r(h+8192>>14),t[E+1]=r(u+8192>>14),t[E]=r(s+8192>>14),E=E+4*i|0}E=4*(p+1)|0,w=(p+1)*n*4|0}}function s(e,t,r){for(var n=3,i=t*r*4|0;i>n;)e[n]=255,n=n+4|0}function u(e){var t=e.src,r=e.width,n=e.height,u=e.toWidth,h=e.toHeight,l=e.scaleX||e.toWidth/e.width,f=e.scaleY||e.toHeight/e.height,c=e.offsetX||0,d=e.offsetY||0,g=e.dest||new Uint8Array(u*h*4),p="undefined"==typeof e.quality?3:e.quality,v=e.alpha||!1;if(1>r||1>n||1>u||1>h)return[];var m=i(p,r,u,l,c),w=i(p,n,h,f,d),E=new Uint8Array(u*n*4);return a(t,E,r,n,u,m),o(E,g,n,u,h,w),v||s(g,u,h),g}var h=14,l=[{win:.5,filter:function(e){return e>=-.5&&.5>e?1:0}},{win:1,filter:function(e){if(-1>=e||e>=1)return 0;if(e>-1.1920929e-7&&1.1920929e-7>e)return 1;var t=e*Math.PI;return Math.sin(t)/t*(.54+.46*Math.cos(t/1))}},{win:2,filter:function(e){if(-2>=e||e>=2)return 0;if(e>-1.1920929e-7&&1.1920929e-7>e)return 1;var t=e*Math.PI;return Math.sin(t)/t*Math.sin(t/2)/(t/2)}},{win:3,filter:function(e){if(-3>=e||e>=3)return 0;if(e>-1.1920929e-7&&1.1920929e-7>e)return 1;var t=e*Math.PI;return Math.sin(t)/t*Math.sin(t/3)/(t/3)}}];t.exports=u},{}],5:[function(e,t){"use strict";function r(e,t,r){for(var n,i,a,o,s,u=t*r,h=new Uint16Array(u),l=0;u>l;l++)n=e[4*l],i=e[4*l+1],a=e[4*l+2],s=n>=i&&n>=a?n:i>=a&&i>=n?i:a,o=i>=n&&a>=n?n:a>=i&&n>=i?i:a,h[l]=257*(s+o)>>1;return h}function n(e,t,n,a,o,s){var u,h,l,f,c,d,g,p,v,m,w,E,_;if(!(0===a||.5>o)){o>2&&(o=2);var T=r(e,t,n),b=new Uint16Array(T);i(b,t,n,o);for(var x=a/100*4096+.5|0,R=257*s|0,y=t*n,A=0;y>A;A++)E=2*(T[A]-b[A]),Math.abs(E)>=R&&(_=4*A,u=e[_],h=e[_+1],l=e[_+2],p=u>=h&&u>=l?u:h>=u&&h>=l?h:l,g=h>=u&&l>=u?u:u>=h&&l>=h?h:l,d=257*(p+g)>>1,g===p?f=c=0:(c=32767>=d?4095*(p-g)/(p+g)|0:4095*(p-g)/(510-p-g)|0,f=u===p?65535*(h-l)/(6*(p-g))|0:h===p?21845+(65535*(l-u)/(6*(p-g))|0):43690+(65535*(u-h)/(6*(p-g))|0)),d+=x*E+2048>>12,d>65535?d=65535:0>d&&(d=0),0===c?u=h=l=d>>8:(m=32767>=d?d*(4096+c)+2048>>12:d+((65535-d)*c+2048>>12),v=2*d-m>>8,m>>=8,w=f+21845&65535,u=w>=43690?v:w>=32767?v+(6*(m-v)*(43690-w)+32768>>16):w>=10922?m:v+(6*(m-v)*w+32768>>16),w=65535&f,h=w>=43690?v:w>=32767?v+(6*(m-v)*(43690-w)+32768>>16):w>=10922?m:v+(6*(m-v)*w+32768>>16),w=f-21845&65535,l=w>=43690?v:w>=32767?v+(6*(m-v)*(43690-w)+32768>>16):w>=10922?m:v+(6*(m-v)*w+32768>>16)),e[_]=u,e[_+1]=h,e[_+2]=l)}}var i=e("glur/mono16");t.exports=n,t.exports.lightness=r},{"glur/mono16":11}],6:[function(e,t){"use strict";t.exports.createRegions=function(e){var t,r,n,i,a,o,s,u=e.toWidth/e.width,h=e.toHeight/e.height,l=Math.floor(e.srcTileSize*u)-2*e.destTileBorder,f=Math.floor(e.srcTileSize*h)-2*e.destTileBorder,c=[];for(i=0;i<e.toHeight;i+=f)for(n=0;n<e.toWidth;n+=l)t=n-e.destTileBorder,0>t&&(t=0),a=n+l+e.destTileBorder-t,t+a>=e.toWidth&&(a=e.toWidth-t),r=i-e.destTileBorder,0>r&&(r=0),o=i+f+e.destTileBorder-r,r+o>=e.toHeight&&(o=e.toHeight-r),s={toX:t,toY:r,toWidth:a,toHeight:o,toInnerX:n,toInnerY:i,toInnerWidth:l,toInnerHeight:f,offsetX:t/u-Math.floor(t/u),offsetY:r/h-Math.floor(r/h),scaleX:u,scaleY:h,x:Math.floor(t/u),y:Math.floor(r/h),width:Math.ceil(a/u),height:Math.ceil(o/h)},c.push(s);return c},t.exports.eachLimit=function(e,t,r,n){0===e.length&&n();for(var i=0,a=0,o=!1,s=function(t){if(!o){if(t)return o=!0,void n(t);a++,a===e.length?n():i<e.length&&r(e[i++],s)}};t>i&&i<e.length;)r(e[i++],s)}},{}],7:[function(e,t){"use strict";t.exports=function(t){var r=e("./resize_array"),n=e("./unsharp");t.onmessage=function(e){var i=e.data;i.dest=new Uint8Array(i.toWidth*i.toHeight*4),r(i),i.unsharpAmount&&n(i.dest,i.toWidth,i.toHeight,i.unsharpAmount,i.unsharpRadius,i.unsharpThreshold),t.postMessage({output:i.dest},[i.dest.buffer])}}},{"./resize_array":4,"./unsharp":5}],8:[function(e,t){"use strict";function r(e,t,r,f){var c=t.getContext("2d",{alpha:Boolean(r.alpha)}),d=u();d.width=Math.min(h,e.width),d.height=Math.min(h,e.height);var g=d.getContext("2d",{alpha:Boolean(r.alpha)});g.globalCompositeOperation="copy";var p=a({width:e.naturalWidth||e.width,height:e.naturalHeight||e.height,srcTileSize:h,toWidth:t.width,toHeight:t.height,destTileBorder:Math.ceil(Math.max(l,2.5*r.unsharpRadius|0))});return o(p,1,function(t,a){g.drawImage(e,t.x,t.y,t.width,t.height,0,0,t.width,t.height);var o=g.getImageData(0,0,t.width,t.height),s=c.createImageData(t.toWidth,t.toHeight),u={src:o.data,dest:s.data,width:t.width,height:t.height,toWidth:t.toWidth,toHeight:t.toHeight,scaleX:t.scaleX,scaleY:t.scaleY,offsetX:t.offsetX,offsetY:t.offsetY,quality:r.quality,alpha:r.alpha,unsharpAmount:r.unsharpAmount,unsharpRadius:r.unsharpRadius,unsharpThreshold:r.unsharpThreshold};n(u),r.unsharpAmount&&i(u.dest,u.toWidth,u.toHeight,u.unsharpAmount,u.unsharpRadius,u.unsharpThreshold),c.putImageData(s,t.toX,t.toY,t.toInnerX-t.toX,t.toInnerY-t.toY,t.toInnerWidth,t.toInnerHeight),a()},f),s()}var n=e("./js/resize_array"),i=e("./js/unsharp"),a=e("./js/utils").createRegions,o=e("./js/utils").eachLimit,s=e("./js/generate_id"),u=e("./js/create_canvas"),h=1024,l=3;t.exports=r,t.exports.terminate=function(){}},{"./js/create_canvas":1,"./js/generate_id":2,"./js/resize_array":4,"./js/unsharp":5,"./js/utils":6}],9:[function(e,t){"use strict";function r(e,t,r,n){var i=t.getContext("2d",{alpha:Boolean(r.alpha)}),a=h();a.width=Math.min(f,e.naturalWidth||e.width),a.height=Math.min(f,e.naturalHeight||e.height);var l=a.getContext("2d",{alpha:Boolean(r.alpha)});l.globalCompositeOperation="copy";var p=o({width:e.naturalWidth||e.width,height:e.naturalHeight||e.height,srcTileSize:f,toWidth:t.width,toHeight:t.height,destTileBorder:Math.ceil(Math.max(c,2.5*r.unsharpRadius|0))}),v=navigator&&navigator.hardwareConcurrency||4,m=r._id||u();return g[m]=!0,s(p,v,function(t,n){l.drawImage(e,t.x,t.y,t.width,t.height,0,0,t.width,t.height);var a=l.getImageData(0,0,t.width,t.height),o={src:a.data,width:t.width,height:t.height,toWidth:t.toWidth,toHeight:t.toHeight,scaleX:t.scaleX,scaleY:t.scaleY,offsetX:t.offsetX,offsetY:t.offsetY,quality:r.quality,alpha:r.alpha,unsharpAmount:r.unsharpAmount,unsharpRadius:r.unsharpRadius,unsharpThreshold:r.unsharpThreshold},s=d.acquire();s.value.onmessage=function(e){var r,a,o,u,h;if(s.release(),!g[m])return void n(!0);if(e.data.err)return void n(e.data.err);if(o=i.createImageData(t.toWidth,t.toHeight),u=e.data.output,h=o.data,h.set)h.set(u);else for(r=0,a=u.length;a>r;r++)h[r]=u[r];i.putImageData(o,t.toX,t.toY,t.toInnerX-t.toX,t.toInnerY-t.toY,t.toInnerWidth,t.toInnerHeight),n()},s.value.postMessage(o,[o.src.buffer])},function(e){g[m]&&(delete g[m],n(e))}),m}function n(e){g[e]&&delete g[e]}var i=e("webworkify"),a=e("./js/worker.js"),o=e("./js/utils").createRegions,s=e("./js/utils").eachLimit,u=e("./js/generate_id"),h=e("./js/create_canvas"),l=e("./js/pool"),f=1024,c=3,d=new l(function(){return{value:i(a),destroy:function(){this.value.terminate()}}}),g={};t.exports=r,t.exports.terminate=n},{"./js/create_canvas":1,"./js/generate_id":2,"./js/pool":3,"./js/utils":6,"./js/worker.js":7,webworkify:13}],10:[function(e,t){"use strict";function r(e){try{(window.console.error||window.console.log).call(window.console,e)}catch(t){}}function n(e){var t=e.getError();if(t!==e.NO_ERROR)throw new Error("gl error "+t)}function i(e){return e.getContext("webgl")||e.getContext("experimental-webgl")}function a(e,t,n){var i=e.createShader(t);return e.shaderSource(i,n),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS)?i:(r("Shader compile error: "+e.getShaderInfoLog(i)+". Source: `"+n+"`"),e.deleteShader(i),null)}function o(e,t,i){var o=a(e,e.VERTEX_SHADER,w[t]),s=a(e,e.FRAGMENT_SHADER,w[i]),u=e.createProgram();return e.attachShader(u,o),e.attachShader(u,s),e.linkProgram(u),e.getProgramParameter(u,e.LINK_STATUS)||(r("Program linking error: "+e.getProgramInfoLog(u)),e.deleteProgram(u)),n(e),u}function s(e,t,r,i,a){var o=e.getAttribLocation(t,r);e.bindBuffer(e.ARRAY_BUFFER,e.createBuffer()),e.bufferData(e.ARRAY_BUFFER,new Float32Array(i),e.STATIC_DRAW),e.enableVertexAttribArray(o),e.vertexAttribPointer(o,a.elementSize,e.FLOAT,!1,0,0),n(e)}function u(e,t,r){var i=e.createTexture();return e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,i),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r),n(e),i}function h(e,t,r,n){var i=e.getUniformLocation(t,r);e.uniform1i(i,n)}function l(e,t,r,n,i){var a=e.getUniformLocation(t,r);e.uniform2f(a,n,i)}function f(e,t,r,n){var i=e,a=e+r,o=t,s=t+n;return[i,o,a,o,i,s,i,s,a,o,a,s]}function c(e,t,r,i){var a=e.createTexture();return e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,a),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,r,i,0,e.RGBA,e.UNSIGNED_BYTE,null),n(e),a}function d(e,t,r,i){var a=c(e,t,r,i),o=e.getParameter(e.FRAMEBUFFER_BINDING),s=e.createFramebuffer();return e.bindFramebuffer(e.FRAMEBUFFER,s),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,a,0),n(e),{fbo:s,texture:a,oldFbo:o}}function g(e,t,r,i,a,u,c,g,p){var v=o(e,"#vsh-basic",u);e.useProgram(v),h(e,v,"u_image",t),l(e,v,"u_imageSize",r,i),l(e,v,"u_resolution",c,g),s(e,v,"a_texCoord",[0,0,1,0,0,1,0,1,1,0,1,1],{elementSize:2}),s(e,v,"a_position",p?f(0,g,c,-g):f(0,0,c,g),{elementSize:2}),e.viewport(0,0,c,g);var m=d(e,a,c,g);return e.viewport(0,0,c,g),e.drawArrays(e.TRIANGLES,0,6),e.bindFramebuffer(e.FRAMEBUFFER,m.oldFbo),n(e),m}function p(e,t,r){var n=e.naturalWidth||e.width,i=e.naturalHeight||e.height,a=t.canvas.width,o=t.canvas.height;t.viewport(0,0,a,o);var s=0;u(t,s,e);var h=2,l=3;g(t,s,n,i,h,"#fsh-lanczos-1d-covolve-horizontal",a,i,!1);var f=g(t,h,a,i,l,"#fsh-lanczos-1d-covolve-vertical",a,o,!0);t.flush();var c=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,c),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,f.texture,0);var d=t.checkFramebufferStatus(t.FRAMEBUFFER);if(d!==t.FRAMEBUFFER_COMPLETE)throw new Error("Bad framebuffer status: "+d);r.alpha||(t.clearColor(1,1,1,1),t.colorMask(!1,!1,!1,!0),t.clear(t.COLOR_BUFFER_BIT));var p=new Uint8Array(a*o*4);t.readPixels(0,0,a,o,t.RGBA,t.UNSIGNED_BYTE,p);var m="undefined"==typeof r.unsharpAmount?0:0|r.unsharpAmount,w="undefined"==typeof r.unsharpRadius?0:r.unsharpRadius,E="undefined"==typeof r.unsharpThreshold?0:0|r.unsharpThreshold;return m&&v(p,a,o,m,w,E),p}var v=e("./js/unsharp"),m=e("./js/generate_id"),w={};w["#vsh-basic"]="precision highp float;\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\n\nuniform vec2 u_resolution;\n\nvarying vec2 v_texCoord;\n\nvoid main() {\n   vec2 clipSpace = a_position / u_resolution * 2.0 - 1.0;\n\n   gl_Position = vec4(clipSpace, 0, 1);\n   v_texCoord = a_texCoord;\n}\n",w["#fsh-lanczos-1d-covolve-horizontal"]="precision highp float;\nuniform vec2 u_resolution;\nuniform sampler2D u_image;\nuniform vec2 u_imageSize;\n\n#define winSize 3.0\n\nvarying vec2 v_texCoord;\n\n#define sinc(a) (sin(a)/a)\n#define M_PI 3.1415926535897932384626433832795\n\nvoid main() {\n  vec2 pixel = vec2(1.) / u_imageSize;\n  gl_FragColor = vec4(0.);\n\n  float total = 0.;\n  float scale = u_imageSize.x / u_resolution.x;\n  float count = winSize * scale * 2.;\n  for (int i = 0; i < 1024*8; i++) {\n    if (float(i) >= count) {\n      break;\n    }\n    float k = float(i) - (count / 2.);\n    vec2 offset = vec2(pixel.x * k, 0.);\n    vec4 c = texture2D(u_image, v_texCoord+offset);\n    float x = k / scale; // max [-3, 3]\n    float xpi = x * M_PI;\n    float b = sinc(xpi) * sinc(xpi / winSize);\n    if (x > -1.19209290E-07 && x < 1.19209290E-07) { \n      b = 1.;\n    }\n    total += b;\n    c *= vec4(b);\n    gl_FragColor += c;\n  }\n  gl_FragColor /= vec4(total);\n}\n",w["#fsh-lanczos-1d-covolve-vertical"]="precision highp float;\nuniform vec2 u_resolution;\nuniform sampler2D u_image;\nuniform vec2 u_imageSize;\n\n#define winSize 3.0\n\nvarying vec2 v_texCoord;\n\n#define sinc(a) (sin(a)/a)\n#define M_PI 3.1415926535897932384626433832795\n\nvoid main() {\n  vec2 pixel = vec2(1.) / u_imageSize;\n  gl_FragColor = vec4(0.);\n\n  float total = 0.;\n  float scale = u_imageSize.y / u_resolution.y;\n  float count = winSize * scale * 2.;\n  for (int i = 0; i < 1024*8; i++) {\n    if (float(i) >= count) {\n      break;\n    }\n    float k = float(i) - (count / 2.);\n    vec2 offset = vec2(0., pixel.y * k);\n    vec4 c = texture2D(u_image, v_texCoord+offset);\n    float x = k / scale; // max [-3, 3]\n    float xpi = x * M_PI;\n    float b = sinc(xpi) * sinc(xpi / winSize);\n    if (x > -1.19209290E-07 && x < 1.19209290E-07) { \n      b = 1.;\n    }\n    total += b;\n    c *= vec4(b);\n    gl_FragColor += c;\n  }\n  gl_FragColor /= vec4(total);\n}\n",t.exports=function(e,t,n,a){var o,s;try{s=document.createElement("canvas"),s.id="pica-webgl-temporarry-canvas",s.height=t.height,s.width=t.width,document.body.appendChild(s),o=i(s);var u=p(e,o,n);o.finish(),document.body.removeChild(s);var h=t.getContext("2d"),l=h.createImageData(t.width,t.height);l.data.set(u),h.putImageData(l,0,0),a(null,u)}catch(f){r(f),o.finish(),document.body.removeChild(s),a(f)}return m()},t.exports.terminate=function(){}},{"./js/generate_id":2,"./js/unsharp":5}],11:[function(e,t){function r(e){.5>e&&(e=.5);var t=Math.exp(.527076)/e,r=Math.exp(-t),n=Math.exp(-2*t),i=(1-r)*(1-r)/(1+2*t*r-n);return a=i,o=i*(t-1)*r,s=i*(t+1)*r,u=-i*n,h=2*r,l=-n,f=(a+o)/(1-h-l),c=(s+u)/(1-h-l),new Float32Array([a,o,s,u,h,l,f,c])}function n(e,t,r,n,i,a){var o,s,u,h,l,f,c,d,g,p,v,m,w,E;for(g=0;a>g;g++){for(f=g*i,c=g,d=0,o=e[f],l=o*n[6],h=l,v=n[0],m=n[1],w=n[4],E=n[5],p=0;i>p;p++)s=e[f],u=s*v+o*m+h*w+l*E,l=h,h=u,o=s,r[d]=h,d++,f++;for(f--,d--,c+=a*(i-1),o=e[f],l=o*n[7],h=l,s=o,v=n[2],m=n[3],p=i-1;p>=0;p--)u=s*v+o*m+h*w+l*E,l=h,h=u,o=s,s=e[f],t[c]=r[d]+h,f--,d--,c-=a}}function i(e,t,i,a){if(a){var o=new Uint16Array(e.length),s=new Float32Array(Math.max(t,i)),u=r(a);n(e,o,s,u,t,i,a),n(o,e,s,u,i,t,a)}}var a,o,s,u,h,l,f,c;t.exports=i},{}],12:[function(e,t){"use strict";function r(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}var n=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;t.exports=Object.assign||function(e){for(var t,a,o=r(e),s=1;s<arguments.length;s++){t=Object(arguments[s]);for(var u in t)n.call(t,u)&&(o[u]=t[u]);if(Object.getOwnPropertySymbols){a=Object.getOwnPropertySymbols(t);for(var h=0;h<a.length;h++)i.call(t,a[h])&&(o[a[h]]=t[a[h]])}}return o}},{}],13:[function(e,t){var r=arguments[3],n=arguments[4],i=arguments[5],a=JSON.stringify;t.exports=function(e){for(var t,o=Object.keys(i),s=0,u=o.length;u>s;s++){var h=o[s];if(i[h].exports===e){t=h;break}}if(!t){t=Math.floor(Math.pow(16,8)*Math.random()).toString(16);for(var l={},s=0,u=o.length;u>s;s++){var h=o[s];l[h]=h}n[t]=[Function(["require","module","exports"],"("+e+")(self)"),l]}var f=Math.floor(Math.pow(16,8)*Math.random()).toString(16),c={};c[t]=t,n[f]=[Function(["require"],"require("+a(t)+")(self)"),c];var d="("+r+")({"+Object.keys(n).map(function(e){return a(e)+":["+n[e][0]+","+a(n[e][1])+"]"}).join(",")+"},{},["+a(f)+"])",g=window.URL||window.webkitURL||window.mozURL||window.msURL;return new Worker(g.createObjectURL(new Blob([d],{type:"text/javascript"})))}},{}],"/":[function(e,t,r){"use strict";function n(e){return Object.prototype.toString.call(e)}function i(e){return"[object Function]"===n(e)}function a(e,t,n,o){if(i(n)&&(o=n,n={}),isNaN(n)||(n={quality:n,alpha:!1}),c||(r.WEBGL=!1),c&&r.WEBGL){r.debug("Resize canvas with WebGL");var s=p(e,t,n,function(i){i?(r.debug("WebGL resize failed, do fallback and cancel next attempts"),r.debug(i),c=!1,a(e,t,w({},n,{_id:s}),o)):o()});return s}return u||(r.WW=!1),u&&r.WW?(r.debug("Resize buffer in WebWorker"),g(e,t,n,o)):(r.debug("Resize buffer sync (freeze event loop)"),d(e,t,n,o))}function o(e,t){var r={src:e.src,dest:e.dest,width:0|e.width,height:0|e.height,toWidth:0|e.toWidth,toHeight:0|e.toHeight,quality:e.quality,alpha:e.alpha,unsharpAmount:e.unsharpAmount,unsharpRadius:e.unsharpRadius,unsharpThreshold:e.unsharpThreshold};r.dest=v(r),r.unsharpAmount&&m(r.dest,r.toWidth,r.toHeight,r.unsharpAmount,r.unsharpRadius,r.unsharpThreshold),t(null,r.dest)}function s(e){d.terminate(e),g.terminate(e),p.terminate(e)}var u="undefined"!=typeof window&&"Worker"in window;if(u)try{var h=e("webworkify")(function(){});h.terminate()}catch(l){u=!1}var f,c=!1;try{"undefined"!=typeof document&&"undefined"!=typeof window&&window.WebGLRenderingContext&&(f=document.createElement("canvas"),(f.getContext("webgl")||f.getContext("experimental-webgl"))&&(c=!0))}catch(l){}finally{f=null}var d=e("./lib/resize_js"),g=e("./lib/resize_js_ww"),p=e("./lib/resize_webgl"),v=e("./lib/js/resize_array"),m=e("./lib/js/unsharp"),w=e("object-assign");r.resizeCanvas=a,r.resizeBuffer=o,r.terminate=s,r.WW=u,r.WEBGL=!1,r.debug=function(){}},{"./lib/js/resize_array":4,"./lib/js/unsharp":5,"./lib/resize_js":8,"./lib/resize_js_ww":9,"./lib/resize_webgl":10,"object-assign":12,webworkify:13}]},{},[])("/")});var Upload=function(){function e(e){i.innerHTML="Bezig...";var t=document.createElement("canvas"),r=new Image;r.src=URL.createObjectURL(e),r.addEventListener("load",function(){var e=Math.min(r.width,a),o=r.height*e/r.width;t.width=e,t.height=o,pica.resizeCanvas(r,t,function(){t.toBlob(function(e){var t=new XMLHttpRequest,r=new FormData;r.append("type","file"),r.append("image",e),t.open("POST","https://api.imgur.com/3/image",!0),t.setRequestHeader("Authorization","Client-ID c9fd3e097596f79"),t.setRequestHeader("Accept","application/json"),t.addEventListener("load",function(){i.innerHTML="klik of sleep";var e=JSON.parse(this.responseText),t=e.data.link.replace(/^http:/,"");n.value+="\n![beschrijving]("+t+")"}),t.upload.addEventListener("progress",function(e){e.lengthComputable}),t.send(r)},"image/jpeg",.8)})})}var t=document.getElementById("imgur-file-upload"),r=document.getElementById("reply-form"),n=document.getElementById("body"),i=document.getElementById("imgur-help-text"),a=631;r.addEventListener("dragover",function(e){e.preventDefault()},!0),r.addEventListener("drop",function(t){t.preventDefault(),e(t.dataTransfer.files[0])},!0),t.addEventListener("change",function(t){e(t.target.files[0])})}();